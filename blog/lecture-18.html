<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Lecture 18</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Lecture 18"/>
            <meta property="og:url" content="http://iacs-courses.seas.harvard.edu/courses/am207/blog/lecture-18.html"/>
            <meta property="og:description" content="The 18th lecture is about Hidden Markov Models"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://iacs-courses.seas.harvard.edu/courses/am207/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://iacs-courses.seas.harvard.edu/courses/am207/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://iacs-courses.seas.harvard.edu/courses/am207/theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="http://iacs-courses.seas.harvard.edu/courses/am207/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>

        <link href="http://iacs-courses.seas.harvard.edu/courses/am207/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="AM207 ATOM Feed"/>
    
        

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}

div.cell{width:100%;padding:5px 5px 5px 0px;margin:2px 0px 2px 7px;outline:none;}
div.prompt{width:11ex;padding:0.4em;margin:0px;font-family:monospace;text-align:right;line-height:1.231em;display:none;}

/*
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_prompt{color:darkred;}*/
</style>

<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
        	config: ['MMLorHTML.js'], 
            jax: ['input/TeX','output/HTML-CSS'],
            TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
            extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
            tex2jax: {
                inlineMath: [ ['$','$'], ['\\(','\\)'] ],
                displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
                processEscapes: true
            },
            //displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: { '.MathJax .mo, .MathJax .mi': {color: 'black ! important'}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>

</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://iacs-courses.seas.harvard.edu/courses/am207/index.html" class="navbar-brand">AM207</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="http://iacs-courses.seas.harvard.edu/courses/am207/schedule.html">Schedule</a></li>
                    <li><a href="http://iacs-courses.seas.harvard.edu/courses/am207/syllabus.html">Syllabus</a></li>
                    <li><a href="http://iacs-courses.seas.harvard.edu/courses/am207/policies.html">Policies</a></li>
                    <li><a href="http://iacs-courses.seas.harvard.edu/courses/am207/resources.html">Resources</a></li>
                    <li><a href="http://iacs-courses.seas.harvard.edu/courses/am207/contact.html">Contact</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://iacs-courses.seas.harvard.edu/courses/am207/archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h2>
                    <a href="http://iacs-courses.seas.harvard.edu/courses/am207/blog/lecture-18.html"
                       rel="bookmark"
                       title="Permalink to Lecture 18">
                        Lecture 18
                    </a>
                </h2>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Thu 10 April 2014
    </span>

    <!--span class="label label-default">Category</span>
    <a href="http://iacs-courses.seas.harvard.edu/courses/am207/category/misc.html">misc</a-->


<span class="label label-default">Tags</span>
	<a href="http://iacs-courses.seas.harvard.edu/courses/am207/tag/lectures.html">lectures</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>You can download this lecture <a href="{filename}/../../notebooks/Lecture18_HMM.ipynb">here</a>.</p>
<p>You can download the data file <a href="{filename}/../../files/AUSCPIALLQINMEI.csv">here</a>.</p>
<p>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="lecture-19-hidden-markov-models">Lecture 19: Hidden Markov Models</h1>
<p>AM207: Pavlos Protopapas, Harvard University</p>
<p>April 10, 2014</p>
<hr>
</hr></div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A simple and effective method of representing observations in the real world is as noisy reflections of a 'true' state. For example, the stock price can be considered a noisy reflection of the actual value of the company. Or, the way you feel on a certain day can be thought of as a noisy relfection of whether of not you have a fever (For instance, sometimes you may feel cold or dizzy even if you aren't sick).</p>
<p>Modeling a time series of events in such a way is called a Hidden Markov Model (HMM). There are the observed states and the latent states that determine them. There is some emmission probability of observed states given the latent state at each time step. There is a also a transition probability between latent states. Consider the below illustration, with x being the latent state and y being the observed state at each time step. The arrows indicate transitions which are decided by a transition probability distribution.</p>
<p><img height="150px" src="hmm.png"/></p>
<p>There are three fundamental problems for HMMs:</p>
<ol>
<li><p>Evaluation: Given the model parameters and observed data, calculate the likelihood of the data.</p>
</li>
<li><p>Decoding: Given the model parameters and observed data, estimate the optimal sequence of hidden states.</p>
</li>
<li><p>Learning: Given just the observed data, estimate the model parameters.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Evaluation">Evaluation<a class="anchor-link" href="#Evaluation">¶</a></h1>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal of the evaluation problem is to return the probability of a given sequence of observations given a sequence of latent states. Let us first introduce the toy problem. In this problem, we consider a person's latent state of health and their apparent symptoms. In this instance, a person is either Healthy or has a Fever, and the possible symptoms are feeling normal, cold, and dizzy. There is no deterministic relationship between the latent and observed states, so we need probabilistic approach to solving the problem of evaluation. </p>
<p><img height="500px" src="hmm1.png"/></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [36]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="o">%</span><span class="k">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [9]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">states</span> <span class="o">=</span> <span class="p">(</span><span class="s">'Healthy'</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">)</span>
<span class="n">end_state</span> <span class="o">=</span> <span class="s">'E'</span>
 
<span class="n">observations</span> <span class="o">=</span> <span class="p">(</span><span class="s">'cold'</span><span class="p">,</span> <span class="s">'normal'</span><span class="p">,</span> <span class="s">'normal'</span><span class="p">)</span>
 
<span class="n">start_probability</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Healthy'</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">}</span>

<span class="n">transition_probability</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'Healthy'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'Healthy'</span><span class="p">:</span> <span class="mf">0.69</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s">'E'</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">},</span>
   <span class="s">'Fever'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'Healthy'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">:</span> <span class="mf">0.59</span><span class="p">,</span> <span class="s">'E'</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">},</span>
   <span class="p">}</span>
 
<span class="n">emission_probability</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'Healthy'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'normal'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">'cold'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">'dizzy'</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
   <span class="s">'Fever'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'normal'</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">'cold'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s">'dizzy'</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">},</span>
   <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Forward-Backward-Algorithm">Forward-Backward Algorithm<a class="anchor-link" href="#Forward-Backward-Algorithm">¶</a></h2>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have the model with transition probabilities in place, we need a way to determine the likelihood of a certain series of observations. In the above example, the observations are feeling cold the first day and normal the next two. We use these observations to return a ????</p>
<p>In the first pass, the forward–backward algorithm computes a set of forward probabilities which provide, for all $k \in \{1, \dots, t\}$, the probability of ending up in any particular state given the first $k$ observations in the sequence, i.e. $P(X_k\ |\  Y_{1:k})$. In the second pass, the algorithm computes a set of backward probabilities which provide the probability of observing the remaining observations given any starting point $k$, i.e. $P(Y_{k+1:t}\ |\ X_k)$. These two sets of probability distributions can then be combined to obtain the distribution over states at any specific point in time given the entire observation sequence:</p>
<p>$P(X_k\ |\ Y_{1:t}) = P(X_k\ |\ Y_{1:k}, Y_{k+1:t}) \propto P(Y_{k+1:t}\ |\ X_k) P(X_k\ |\ Y_{1:k})$</p>
<p>The last step follows from an application of Bayes' rule and the conditional independence of $Y_{k+1:t}$ and $Y_{1:k}$ given $X_k$.</p>
<p>As outlined above, the algorithm involves three steps:</p>
<ol>
<li><p>computing forward probabilities</p>
</li>
<li><p>computing backward probabilities</p>
</li>
<li><p>computing smoothed values.</p>
</li>
</ol>
<p>The forward and backward steps may also be called "forward message pass" and "backward message pass" - these terms are due to the message-passing used in general belief propagation approaches. At each single observation in the sequence, probabilities to be used for calculations at the next observation are computed. The smoothing step can be calculated simultaneously during the backward pass. This step allows the algorithm to take into account any past observations of output for computing more accurate results.</p>
<p>The forward–backward algorithm can be used to find the most likely state for any point in time. It cannot, however, be used to find the most likely sequence of states (see Decoding, and specifically the Viterbi algorithm).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [10]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="k">def</span> <span class="nf">fwd_bkw</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">a_0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">end_st</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
 
    <span class="n">fwd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f_prev</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># forward part of the algorithm</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">f_curr</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># base case for the forward part</span>
                <span class="n">prev_f_sum</span> <span class="o">=</span> <span class="n">a_0</span><span class="p">[</span><span class="n">st</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prev_f_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f_prev</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">st</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
 
            <span class="n">f_curr</span><span class="p">[</span><span class="n">st</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">st</span><span class="p">][</span><span class="n">y_i</span><span class="p">]</span> <span class="o">*</span> <span class="n">prev_f_sum</span>
 
        <span class="n">fwd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_curr</span><span class="p">)</span>
        <span class="n">f_prev</span> <span class="o">=</span> <span class="n">f_curr</span>
 
    <span class="n">p_fwd</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f_curr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">end_st</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
 
    <span class="n">bkw</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">b_prev</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># backward part of the algorithm</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y_i_plus</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="p">(</span><span class="bp">None</span><span class="p">,))):</span>
        <span class="n">b_curr</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># base case for backward part</span>
                <span class="n">b_curr</span><span class="p">[</span><span class="n">st</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">st</span><span class="p">][</span><span class="n">end_st</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b_curr</span><span class="p">[</span><span class="n">st</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">st</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">y_i_plus</span><span class="p">]</span><span class="o">*</span><span class="n">b_prev</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
 
        <span class="n">bkw</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">b_curr</span><span class="p">)</span>
        <span class="n">b_prev</span> <span class="o">=</span> <span class="n">b_curr</span>
 
    <span class="n">p_bkw</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a_0</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">b_curr</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
 
    <span class="c"># merging the two parts</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
        <span class="n">posterior</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">st</span><span class="p">:</span> <span class="n">fwd</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">st</span><span class="p">]</span><span class="o">*</span><span class="n">bkw</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">st</span><span class="p">]</span><span class="o">/</span><span class="n">p_fwd</span> <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">states</span><span class="p">})</span>
 
    <span class="k">assert</span> <span class="n">p_fwd</span> <span class="o">==</span> <span class="n">p_bkw</span>
    <span class="k">return</span> <span class="n">fwd</span><span class="p">,</span> <span class="n">bkw</span><span class="p">,</span> <span class="n">posterior</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [11]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="k">def</span> <span class="nf">example</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">fwd_bkw</span><span class="p">(</span><span class="n">observations</span><span class="p">,</span>
                   <span class="n">states</span><span class="p">,</span>
                   <span class="n">start_probability</span><span class="p">,</span>
                   <span class="n">transition_probability</span><span class="p">,</span>
                   <span class="n">emission_probability</span><span class="p">,</span>
                   <span class="n">end_state</span><span class="p">)</span>
 
<span class="n">fwd</span><span class="p">,</span> <span class="n">bkw</span><span class="p">,</span> <span class="n">posterior</span> <span class="o">=</span> <span class="n">example</span><span class="p">()</span>
<span class="k">print</span> <span class="n">posterior</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[{&amp;apos;Healthy&amp;apos;: 0.7523637371047066, &amp;apos;Fever&amp;apos;: 0.24763626289529342}, {&amp;apos;Healthy&amp;apos;: 0.9154595401170142, &amp;apos;Fever&amp;apos;: 0.08454045988298578}, {&amp;apos;Healthy&amp;apos;: 0.907504985311503, &amp;apos;Fever&amp;apos;: 0.09249501468849691}]

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Decoding">Decoding<a class="anchor-link" href="#Decoding">¶</a></h1>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Decoding an HMM is answering the question: "Given the transition model, what is the most likely sequence of latent states that could have produced the observed states?" This is different than the evaulation problem because it predicts an entire sequence rather than giving a probability distribution over the latent states for each time step. </p>
<p>A naive way of solving the decoding problem is simply by exhausting evaulation, i.e. to list all possible sequences of hidden states and finding the probability of the observed sequence for each of the combinations. The most probable sequence of hidden states is that combination that maximises P(observed sequence | hidden state sequence).</p>
<p>This approach is viable, but to find the most probable sequence by exhaustively calculating each combination is computationally expensive. As with the forward algorithm, we can use the time invariance of the probabilities to reduce the complexity of the calculation.</p>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Viterbi">Viterbi<a class="anchor-link" href="#Viterbi">¶</a></h1>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most popular algorithm for the HMM  decoding problem is the Viterbi algorithm, a dynamic programming solution (for the most likely set of hidden states). Viterbi recursively finds the most probable sequence of hidden states given an observation sequence and a HMM. It does it by first defining the partial probability  $d$, which is the probability of reaching a particular intermediate state in the time sequence. These partial probabilities differ from those calculated in the forward algorithm since they represent the probability of the most probable path to a state at time $t$, and not a total. Thus $d (X_i,t)$ is the maximum probability of all sequences ending at state $X_i$ at time $t$, and the partial best path is the sequence which achieves this maximal probability. Thus, to calculate the partial probabilities $d$ at time $t$, we only need to know the probabilties $d$ at time $t-1$. </p>
<p>$$d(X_i, t) = \max_{\forall j}(d(X_j, t-1) \times P(X_j,X_i))$$</p>
<p>In the below implementation, the accuracy is assessed by generating the hidden and observed states ourselves and then comparing them against the Viterbi proposal.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [12]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="c"># a slightly more realistic version of the 'Healthy' vs. 'Fever' model is outlined and then generated</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">states</span> <span class="o">=</span> <span class="p">(</span><span class="s">'Healthy'</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">)</span>
<span class="n">observations</span> <span class="o">=</span> <span class="p">(</span><span class="s">'normal'</span><span class="p">,</span> <span class="s">'cold'</span><span class="p">,</span> <span class="s">'dizzy'</span><span class="p">)</span>
<span class="n">start_probability</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Healthy'</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">}</span>

<span class="n">transition_probability</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'Healthy'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'Healthy'</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span>
   <span class="s">'Fever'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'Healthy'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">'Fever'</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
   <span class="p">}</span>

<span class="n">emission_probability</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'Healthy'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'normal'</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s">'cold'</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s">'dizzy'</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
   <span class="s">'Fever'</span> <span class="p">:</span> <span class="p">{</span><span class="s">'normal'</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">'cold'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">'dizzy'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
   <span class="p">}</span>

<span class="c"># A random HMM is generated using the probability matricies defined above</span>
<span class="c"># Both the latent and visible states are generated in order to later assess the accuracy of our algorithms</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">hidden</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">visible</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c"># generate observations</span>
<span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">start_probability</span><span class="p">[</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
    <span class="n">hidden</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">hidden</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">current_state</span> <span class="o">=</span> <span class="n">hidden</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">transition_probability</span><span class="p">[</span><span class="n">current_state</span><span class="p">][</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
        <span class="n">hidden</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hidden</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">observation</span> <span class="ow">in</span> <span class="n">observations</span><span class="p">:</span>
        <span class="n">prev</span> <span class="o">+=</span> <span class="n">emission_probability</span><span class="p">[</span><span class="n">current_state</span><span class="p">][</span><span class="n">observation</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">prev</span><span class="p">:</span>
            <span class="n">visible</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
            <span class="k">break</span>

<span class="c"># fixes issue of creating extra hidden state</span>
<span class="n">hidden</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">
    Out[12]:</div>
<div class="box-flex1 output_subarea output_pyout">
<pre>
&amp;apos;Healthy&amp;apos;
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [13]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="k">def</span> <span class="nf">print_dptable</span><span class="p">(</span><span class="n">V</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">"    "</span> <span class="o">+</span> <span class="s">" "</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">"</span><span class="si">%7d</span><span class="s">"</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="p">)))</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s">"</span><span class="si">%.5s</span><span class="s">: "</span> <span class="o">%</span> <span class="n">y</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">"</span><span class="si">%.7s</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="s">"</span><span class="si">%f</span><span class="s">"</span> <span class="o">%</span> <span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">V</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">viterbi</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">start_p</span><span class="p">,</span> <span class="n">trans_p</span><span class="p">,</span> <span class="n">emit_p</span><span class="p">):</span>
    <span class="n">V</span> <span class="o">=</span> <span class="p">[{}]</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">{}</span>
 
    <span class="c"># Initialize base cases (t == 0)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
        <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_p</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">emit_p</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">path</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
 
    <span class="c"># Run Viterbi for t &gt; 0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">)):</span>
        <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
        <span class="n">newpath</span> <span class="o">=</span> <span class="p">{}</span>
 
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">V</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y0</span><span class="p">]</span> <span class="o">*</span> <span class="n">trans_p</span><span class="p">[</span><span class="n">y0</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">emit_p</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">obs</span><span class="p">[</span><span class="n">t</span><span class="p">]],</span> <span class="n">y0</span><span class="p">)</span> <span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
            <span class="n">V</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
            <span class="n">newpath</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
 
        <span class="c"># Don't need to remember the old paths</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">newpath</span>
     
    <span class="c">#print_dptable(V)</span>
    <span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">V</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">path</span><span class="p">[</span><span class="n">state</span><span class="p">])</span>

<span class="c"># input the generated markov model</span>
<span class="k">def</span> <span class="nf">example</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">viterbi</span><span class="p">(</span><span class="n">visible</span><span class="p">,</span>
                   <span class="n">states</span><span class="p">,</span>
                   <span class="n">start_probability</span><span class="p">,</span>
                   <span class="n">transition_probability</span><span class="p">,</span>
                   <span class="n">emission_probability</span><span class="p">)</span>

<span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">p_hidden</span><span class="p">)</span> <span class="o">=</span> <span class="n">example</span><span class="p">()</span>

<span class="c"># assess accuracy of the HMM model</span>
<span class="n">wrong</span><span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hidden</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">hidden</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">p_hidden</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">wrong</span> <span class="o">=</span> <span class="n">wrong</span> <span class="o">+</span> <span class="mi">1</span>
<span class="k">print</span> <span class="s">"accuracy: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">wrong</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
accuracy: 0.73

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Learning">Learning<a class="anchor-link" href="#Learning">¶</a></h1>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The learning problem with HMMs is about estimating the maximum liklihood model which generated the observed sequence. </p>
<p>One popular method of doing this the Baum-Welch algorithm which is basically an EM forward-backward implementation which alternates between estimating the most likely hidden states, and the most likely model that produced them. While we won't go into detail regarding the details, there exists an sklearn implementation which we can use for a fun example below.</p>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stock-Price-as-a-HMM">Stock Price as a HMM<a class="anchor-link" href="#Stock-Price-as-a-HMM">¶</a></h2>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that you have seen a trivial example of the use of HMM's to infer the underlying state of a time-series of observations, consider a more complicated user-case: the stock market. Below is example code for using sklearn's GaussianHMM module to infer a set number of hidden states from Google stock data. What is underlying stock price? A non-cynical investor would say the company's value. What the below HMM implementation does is classify each day into one of, in this case 3, latent states. These states could be thought of as: "Google had a good day", "Google had a neutral day", and "Google had a bad day". </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [37]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">matplotlib.finance</span> <span class="kn">import</span> <span class="n">quotes_historical_yahoo</span>
<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">YearLocator</span><span class="p">,</span> <span class="n">MonthLocator</span><span class="p">,</span> <span class="n">DateFormatter</span>
<span class="kn">from</span> <span class="nn">sklearn.hmm</span> <span class="kn">import</span> <span class="n">GaussianHMM</span>

<span class="c">###############################################################################</span>
<span class="c"># Downloading the data</span>
<span class="n">date1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># start date</span>
<span class="n">date2</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c"># end date</span>
<span class="c"># get quotes from yahoo finance</span>
<span class="n">quotes</span> <span class="o">=</span> <span class="n">quotes_historical_yahoo</span><span class="p">(</span><span class="s">"GOOG"</span><span class="p">,</span> <span class="n">date1</span><span class="p">,</span> <span class="n">date2</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">quotes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_pyerr">
<pre>
<span class="ansired">---------------------------------------------------------------------------</span>
<span class="ansired">HTTPError</span>                                 Traceback (most recent call last)
<span class="ansigreen">&lt;ipython-input-37-bfc36dcc9574&gt;</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      9</span> date2 <span class="ansiblue">=</span> datetime<span class="ansiblue">.</span>date<span class="ansiblue">(</span><span class="ansicyan">2012</span><span class="ansiblue">,</span> <span class="ansicyan">1</span><span class="ansiblue">,</span> <span class="ansicyan">6</span><span class="ansiblue">)</span>  <span class="ansired"># end date</span><span class="ansiblue"></span>
<span class="ansigreen">     10</span> <span class="ansired"># get quotes from yahoo finance</span><span class="ansiblue"></span><span class="ansiblue"></span>
<span class="ansigreen">---&gt; 11</span><span class="ansired"> </span>quotes <span class="ansiblue">=</span> quotes_historical_yahoo<span class="ansiblue">(</span><span class="ansiblue">"GOOG"</span><span class="ansiblue">,</span> date1<span class="ansiblue">,</span> date2<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">     12</span> <span class="ansigreen">if</span> len<span class="ansiblue">(</span>quotes<span class="ansiblue">)</span> <span class="ansiblue">==</span> <span class="ansicyan">0</span><span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">     13</span>     <span class="ansigreen">raise</span> SystemExit<span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/lib/python2.7/site-packages/matplotlib/finance.pyc</span> in <span class="ansicyan">quotes_historical_yahoo</span><span class="ansiblue">(ticker, date1, date2, asobject, adjusted, cachename)</span>
<span class="ansigreen">    234</span>     <span class="ansired">#    warnings.warn("Recommend changing to asobject=None")</span><span class="ansiblue"></span><span class="ansiblue"></span>
<span class="ansigreen">    235</span> <span class="ansiblue"></span>
<span class="ansigreen">--&gt; 236</span><span class="ansired">     </span>fh <span class="ansiblue">=</span> fetch_historical_yahoo<span class="ansiblue">(</span>ticker<span class="ansiblue">,</span> date1<span class="ansiblue">,</span> date2<span class="ansiblue">,</span> cachename<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    237</span> <span class="ansiblue"></span>
<span class="ansigreen">    238</span>     <span class="ansigreen">try</span><span class="ansiblue">:</span><span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/lib/python2.7/site-packages/matplotlib/finance.pyc</span> in <span class="ansicyan">fetch_historical_yahoo</span><span class="ansiblue">(ticker, date1, date2, cachename, dividends)</span>
<span class="ansigreen">    195</span>         <span class="ansigreen">else</span><span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    196</span>             mkdirs<span class="ansiblue">(</span>os<span class="ansiblue">.</span>path<span class="ansiblue">.</span>abspath<span class="ansiblue">(</span>os<span class="ansiblue">.</span>path<span class="ansiblue">.</span>dirname<span class="ansiblue">(</span>cachename<span class="ansiblue">)</span><span class="ansiblue">)</span><span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">--&gt; 197</span><span class="ansired">             </span><span class="ansigreen">with</span> contextlib<span class="ansiblue">.</span>closing<span class="ansiblue">(</span>urlopen<span class="ansiblue">(</span>url<span class="ansiblue">)</span><span class="ansiblue">)</span> <span class="ansigreen">as</span> urlfh<span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    198</span>                 <span class="ansigreen">with</span> open<span class="ansiblue">(</span>cachename<span class="ansiblue">,</span> <span class="ansiblue">&amp;apos;wb&amp;apos;</span><span class="ansiblue">)</span> <span class="ansigreen">as</span> fh<span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    199</span>                     fh<span class="ansiblue">.</span>write<span class="ansiblue">(</span>urlfh<span class="ansiblue">.</span>read<span class="ansiblue">(</span><span class="ansiblue">)</span><span class="ansiblue">)</span><span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/python.app/Contents/lib/python2.7/urllib2.pyc</span> in <span class="ansicyan">urlopen</span><span class="ansiblue">(url, data, timeout)</span>
<span class="ansigreen">    125</span>     <span class="ansigreen">if</span> _opener <span class="ansigreen">is</span> None<span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    126</span>         _opener <span class="ansiblue">=</span> build_opener<span class="ansiblue">(</span><span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">--&gt; 127</span><span class="ansired">     </span><span class="ansigreen">return</span> _opener<span class="ansiblue">.</span>open<span class="ansiblue">(</span>url<span class="ansiblue">,</span> data<span class="ansiblue">,</span> timeout<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    128</span> <span class="ansiblue"></span>
<span class="ansigreen">    129</span> <span class="ansigreen">def</span> install_opener<span class="ansiblue">(</span>opener<span class="ansiblue">)</span><span class="ansiblue">:</span><span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/python.app/Contents/lib/python2.7/urllib2.pyc</span> in <span class="ansicyan">open</span><span class="ansiblue">(self, fullurl, data, timeout)</span>
<span class="ansigreen">    408</span>         <span class="ansigreen">for</span> processor <span class="ansigreen">in</span> self<span class="ansiblue">.</span>process_response<span class="ansiblue">.</span>get<span class="ansiblue">(</span>protocol<span class="ansiblue">,</span> <span class="ansiblue">[</span><span class="ansiblue">]</span><span class="ansiblue">)</span><span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    409</span>             meth <span class="ansiblue">=</span> getattr<span class="ansiblue">(</span>processor<span class="ansiblue">,</span> meth_name<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">--&gt; 410</span><span class="ansired">             </span>response <span class="ansiblue">=</span> meth<span class="ansiblue">(</span>req<span class="ansiblue">,</span> response<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    411</span> <span class="ansiblue"></span>
<span class="ansigreen">    412</span>         <span class="ansigreen">return</span> response<span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/python.app/Contents/lib/python2.7/urllib2.pyc</span> in <span class="ansicyan">http_response</span><span class="ansiblue">(self, request, response)</span>
<span class="ansigreen">    521</span>         <span class="ansigreen">if</span> <span class="ansigreen">not</span> <span class="ansiblue">(</span><span class="ansicyan">200</span> <span class="ansiblue">&lt;=</span> code <span class="ansiblue">&lt;</span> <span class="ansicyan">300</span><span class="ansiblue">)</span><span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    522</span>             response = self.parent.error(
<span class="ansigreen">--&gt; 523</span><span class="ansired">                 &amp;apos;http&amp;apos;, request, response, code, msg, hdrs)
</span><span class="ansigreen">    524</span> <span class="ansiblue"></span>
<span class="ansigreen">    525</span>         <span class="ansigreen">return</span> response<span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/python.app/Contents/lib/python2.7/urllib2.pyc</span> in <span class="ansicyan">error</span><span class="ansiblue">(self, proto, *args)</span>
<span class="ansigreen">    446</span>         <span class="ansigreen">if</span> http_err<span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    447</span>             args <span class="ansiblue">=</span> <span class="ansiblue">(</span>dict<span class="ansiblue">,</span> <span class="ansiblue">&amp;apos;default&amp;apos;</span><span class="ansiblue">,</span> <span class="ansiblue">&amp;apos;http_error_default&amp;apos;</span><span class="ansiblue">)</span> <span class="ansiblue">+</span> orig_args<span class="ansiblue"></span>
<span class="ansigreen">--&gt; 448</span><span class="ansired">             </span><span class="ansigreen">return</span> self<span class="ansiblue">.</span>_call_chain<span class="ansiblue">(</span><span class="ansiblue">*</span>args<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    449</span> <span class="ansiblue"></span>
<span class="ansigreen">    450</span> <span class="ansired"># XXX probably also want an abstract factory that knows when it makes</span><span class="ansiblue"></span><span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/python.app/Contents/lib/python2.7/urllib2.pyc</span> in <span class="ansicyan">_call_chain</span><span class="ansiblue">(self, chain, kind, meth_name, *args)</span>
<span class="ansigreen">    380</span>             func <span class="ansiblue">=</span> getattr<span class="ansiblue">(</span>handler<span class="ansiblue">,</span> meth_name<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    381</span> <span class="ansiblue"></span>
<span class="ansigreen">--&gt; 382</span><span class="ansired">             </span>result <span class="ansiblue">=</span> func<span class="ansiblue">(</span><span class="ansiblue">*</span>args<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    383</span>             <span class="ansigreen">if</span> result <span class="ansigreen">is</span> <span class="ansigreen">not</span> None<span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    384</span>                 <span class="ansigreen">return</span> result<span class="ansiblue"></span>

<span class="ansigreen">/Users/pavlos/anaconda/python.app/Contents/lib/python2.7/urllib2.pyc</span> in <span class="ansicyan">http_error_default</span><span class="ansiblue">(self, req, fp, code, msg, hdrs)</span>
<span class="ansigreen">    529</span> <span class="ansigreen">class</span> HTTPDefaultErrorHandler<span class="ansiblue">(</span>BaseHandler<span class="ansiblue">)</span><span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">    530</span>     <span class="ansigreen">def</span> http_error_default<span class="ansiblue">(</span>self<span class="ansiblue">,</span> req<span class="ansiblue">,</span> fp<span class="ansiblue">,</span> code<span class="ansiblue">,</span> msg<span class="ansiblue">,</span> hdrs<span class="ansiblue">)</span><span class="ansiblue">:</span><span class="ansiblue"></span>
<span class="ansigreen">--&gt; 531</span><span class="ansired">         </span><span class="ansigreen">raise</span> HTTPError<span class="ansiblue">(</span>req<span class="ansiblue">.</span>get_full_url<span class="ansiblue">(</span><span class="ansiblue">)</span><span class="ansiblue">,</span> code<span class="ansiblue">,</span> msg<span class="ansiblue">,</span> hdrs<span class="ansiblue">,</span> fp<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">    532</span> <span class="ansiblue"></span>
<span class="ansigreen">    533</span> <span class="ansigreen">class</span> HTTPRedirectHandler<span class="ansiblue">(</span>BaseHandler<span class="ansiblue">)</span><span class="ansiblue">:</span><span class="ansiblue"></span>

<span class="ansired">HTTPError</span>: HTTP Error 404: Not Found</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [38]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="c"># unpack quotes</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">close_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">])</span>
<span class="n">volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">])[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c"># take diff of close value</span>
<span class="c"># this makes len(diff) = len(close_t) - 1</span>
<span class="c"># therefore, others quantity also need to be shifted</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">close_v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">close_v</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">close_v</span> <span class="o">=</span> <span class="n">close_v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c"># pack diff and volume for training</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">diff</span><span class="p">,</span> <span class="n">volume</span><span class="p">])</span>

<span class="c">###############################################################################</span>
<span class="c"># Run Gaussian HMM</span>
<span class="k">print</span> <span class="s">"fitting to HMM and decoding ..."</span><span class="p">,</span>
<span class="n">n_components</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c"># make an HMM instance and execute fit</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianHMM</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="s">"diag"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">X</span><span class="p">],</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c"># predict the optimal sequence of internal hidden state</span>
<span class="n">hidden_states</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"done</span><span class="se">\n</span><span class="s">"</span>

<span class="c">###############################################################################</span>
<span class="c"># print trained parameters and plot</span>
<span class="k">print</span> <span class="s">"Transition matrix"</span>
<span class="k">print</span> <span class="n">model</span><span class="o">.</span><span class="n">transmat_</span>
<span class="k">print</span> <span class="s">""</span>

<span class="k">print</span> <span class="s">"means and vars of each hidden state"</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">"</span><span class="si">%d</span><span class="s">th hidden state"</span> <span class="o">%</span> <span class="n">i</span>
    <span class="k">print</span> <span class="s">"mean = "</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">print</span> <span class="s">"var = "</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">covars_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">print</span> <span class="s">""</span>

<span class="n">years</span> <span class="o">=</span> <span class="n">YearLocator</span><span class="p">()</span>   <span class="c"># every year</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">MonthLocator</span><span class="p">()</span>  <span class="c"># every month</span>
<span class="n">yearsFmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s">'%Y'</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span>
    <span class="c"># use fancy indexing to plot data in each state</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">hidden_states</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_date</span><span class="p">(</span><span class="n">dates</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">close_v</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"</span><span class="si">%d</span><span class="s">th hidden state"</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c"># format the ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">yearsFmt</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>

<span class="c"># format the coords message box</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fmt_xdata</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s">'%Y-%m-</span><span class="si">%d</span><span class="s">'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fmt_ydata</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">'$</span><span class="si">%1.2f</span><span class="s">'</span> <span class="o">%</span> <span class="n">x</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_pyerr">
<pre>
<span class="ansired">---------------------------------------------------------------------------</span>
<span class="ansired">NameError</span>                                 Traceback (most recent call last)
<span class="ansigreen">&lt;ipython-input-38-8c4bf1e0749b&gt;</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      1</span> <span class="ansired"># unpack quotes</span><span class="ansiblue"></span><span class="ansiblue"></span>
<span class="ansigreen">----&gt; 2</span><span class="ansired"> </span>dates <span class="ansiblue">=</span> np<span class="ansiblue">.</span>array<span class="ansiblue">(</span><span class="ansiblue">[</span>q<span class="ansiblue">[</span><span class="ansicyan">0</span><span class="ansiblue">]</span> <span class="ansigreen">for</span> q <span class="ansigreen">in</span> quotes<span class="ansiblue">]</span><span class="ansiblue">,</span> dtype<span class="ansiblue">=</span>int<span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">      3</span> close_v <span class="ansiblue">=</span> np<span class="ansiblue">.</span>array<span class="ansiblue">(</span><span class="ansiblue">[</span>q<span class="ansiblue">[</span><span class="ansicyan">2</span><span class="ansiblue">]</span> <span class="ansigreen">for</span> q <span class="ansigreen">in</span> quotes<span class="ansiblue">]</span><span class="ansiblue">)</span><span class="ansiblue"></span>
<span class="ansigreen">      4</span> volume <span class="ansiblue">=</span> np<span class="ansiblue">.</span>array<span class="ansiblue">(</span><span class="ansiblue">[</span>q<span class="ansiblue">[</span><span class="ansicyan">2</span><span class="ansiblue">]</span> <span class="ansigreen">for</span> q <span class="ansigreen">in</span> quotes<span class="ansiblue">]</span><span class="ansiblue">)</span><span class="ansiblue">[</span><span class="ansicyan">1</span><span class="ansiblue">:</span><span class="ansiblue">]</span><span class="ansiblue"></span>
<span class="ansigreen">      5</span> <span class="ansiblue"></span>

<span class="ansired">NameError</span>: name &amp;apos;quotes&amp;apos; is not defined</pre>
</div>
</div>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Kalman-Filter">Kalman Filter<a class="anchor-link" href="#Kalman-Filter">¶</a></h2>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Kalman filters solve the learning problem like Bauch-Welch except that the hidden state variables are seen in a continuous space, rather than a discrete one. Additionally, the hidden Markov model can represent an arbitrary distribution for the next value of the state variables, in contrast to the Gaussian noise model that is used for the Kalman filter.</p>
<p>They are modelled on a Markov chain built on linear operators perturbed by errors that may include Gaussian noise. The state of the system is represented as a vector of real numbers. At each discrete time increment, a linear operator is applied to the state to generate the new state, with some noise mixed in, and optionally some information from the controls on the system if they are known. Then, another linear operator mixed with more noise generates the observed outputs from the true ("hidden") state.</p>
<p>In order to use the Kalman filter to estimate the internal state of a process given only a sequence of noisy observations, one must model the process in accordance with the framework of the Kalman filter. This means specifying the following matrices: $Fk$, the state-transition model; Hk, the observation model; $Qk$, the covariance of the process noise; $Rk$, the covariance of the observation noise; and sometimes $Bk$, the control-input model, for each time-step, $k$, as described below.</p>
<p>Model underlying the Kalman filter. Squares represent matrices. Ellipses represent multivariate normal distributions (with the mean and covariance matrix enclosed). Unenclosed values are vectors. In the simple case, the various matrices are constant with time, and thus the subscripts are dropped, but the Kalman filter allows any of them to change each time step.
The Kalman filter model assumes the true state at time $k$ is evolved from the state at $k−1$ according to</p>
<p>$$x_{k} = F_{k} x_{k-1} + B_{k} u_{k} + w_{k} $$</p>
<p>where</p>
<p>$Fk$ is the state transition model which is applied to the previous state $xk−1$;</p>
<p>$Bk$ is the control-input model which is applied to the control vector $uk$;</p>
<p>$wk$ is the process noise which is assumed to be drawn from a zero mean multivariate normal distribution with covariance $Qk$.</p>
<p>$w_{k} \sim N(0, Q_k) $</p>
<p>At time k an observation (or measurement) zk of the true state xk is made according to</p>
<p>$z_{k} = H_{k} x_{k} + v_{k}$</p>
<p>where $Hk$ is the observation model which maps the true state space into the observed space and $vk$ is the observation noise which is assumed to be zero mean Gaussian white noise with covariance $Rk$.
$v_{k} \sim N(0, R_k) $</p>
<p>The initial state, and the noise vectors at each step ${x0, w1, ..., wk, v1 ... vk}$ are all assumed to be mutually independent.</p>
<p>Many real dynamical systems do not exactly fit this model. In fact, unmodelled dynamics can seriously degrade the filter performance, even when it was supposed to work with unknown stochastic signals as inputs. The reason for this is that the effect of unmodelled dynamics depends on the input, and, therefore, can bring the estimation algorithm to instability (it diverges). On the other hand, independent white noise signals will not make the algorithm diverge. The problem of separating between measurement noise and unmodelled dynamics is a difficult one and is treated in control theory under the framework of robust control.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [42]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="c"># Kalman filter example demo in Python</span>

<span class="c"># A Python implementation of the example given in pages 11-15 of "An</span>
<span class="c"># Introduction to the Kalman Filter" by Greg Welch and Gary Bishop,</span>
<span class="c"># University of North Carolina at Chapel Hill, Department of Computer</span>
<span class="c"># Science, TR 95-041,</span>
<span class="c"># http://www.cs.unc.edu/~welch/kalman/kalmanIntro.html</span>

<span class="c"># by Andrew D. Straw</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="n">n_iter</span><span class="o">=</span><span class="mi">50</span>

<span class="c"># intial parameters</span>
<span class="n">sz</span><span class="o">=</span><span class="mi">50</span>
<span class="n">x</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">5</span> <span class="c"># truth value</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">)</span> <span class="c"># observations (normal about x, sigma=0.1)</span>

<span class="n">Q</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="c"># process variance</span>

<span class="c"># allocate space for arrays</span>
<span class="n">xhat</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span>      <span class="c"># a posteri estimate of x</span>
<span class="n">P</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span>         <span class="c"># a posteri error estimate</span>
<span class="n">xhatminus</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="c"># a priori estimate of x</span>
<span class="n">Pminus</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span>    <span class="c"># a priori error estimate</span>
<span class="n">K</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span>         <span class="c"># gain or blending factor</span>

<span class="n">R</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">2</span> <span class="c"># estimate of measurement variance, change to see effect</span>

<span class="c"># intial guesses</span>
<span class="n">xhat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sz</span><span class="p">):</span>
    <span class="c"># time update</span>
    <span class="n">xhatminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">xhat</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Q</span>

    <span class="c"># measurement update</span>
    <span class="n">K</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span> <span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">R</span> <span class="p">)</span>
    <span class="n">xhat</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">xhatminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">K</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">xhatminus</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">K</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="s">'k+'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'noisy measurements'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xhat</span><span class="p">,</span><span class="s">'b-'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'a posteri estimate'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'truth value'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Iteration'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Voltage'</span><span class="p">)</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">valid_iter</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_iter</span><span class="p">)</span> <span class="c"># Pminus not valid at step 0</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">valid_iter</span><span class="p">,</span><span class="n">Pminus</span><span class="p">[</span><span class="n">valid_iter</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s">'a priori error estimate'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Iteration'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$(Voltage)^2$'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span><span class="s">'ylim'</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mo">01</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">
<img src="data:image/png;base64,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
yc3NpV27dkybNo23336bvLw84uLicDgcfPfdd8THx1ea3qo4HA46dPDOFL1792727dtHUlKS57ni
4mIuuugiz3a7du3KpL9NmzYV/scTJ07w7bffUlhYSFpammf/kpKSMue69GfVvHlzz9+636N0PcaI
ESOYNGkSv/zlL9m9ezfXXnstTzzxBPHx8VX+nzWlOgyRGNW+ffsyzWZPnjzJoUOHylww3QYMGMCi
RYvIy8tjzJgx3HDDDZ7XJk6cyBtvvMFbb73FkCFDylwQayMjI4MlS5Zw5MgRz1JQUEBaWhrz589n
8eLFLF++nGPHjrFr167SkwJVmt4WLVpQUFDgeY8DBw5UeN/SF+WMjAw6d+5cJg3Hjx/31NtUpyK6
Y8eONGnShEOHDnmOdezYMb788suA/t7Xe919992sW7eOLVu2sG3bNh5//PGA01MTChgiIRaM4bSD
OSS3+6I6fvx45syZw8aNGzlz5gxTp05l0KBBFXIXhYWFzJs3j2PHjtGgQQPi4+Np0KCB5/VrrrmG
zz//nGeffZabb745aOm88847mTp1Kt988w0AeXl5LF5sJ+U8ceIETZo0ITk5mZMnTzJ16tSA0tu3
b182b97Mxo0bOX36dIVcmyk33tLAgQOJj49n9uzZnDp1iuLiYjZt2sS6det87u9PWloao0aN4le/
+hX5+fmUlJSwY8cOPvnkk4D+PiUlhdJTUa9bt441a9ZQWFhI8+bNadq0aZnPJRQUMERCLJIChsPh
8Nyp/vCHP2TGjBlcd911tG/fnl27drFgwYIy+7q98cYbdO7cmcTERF544QXmzZvnea1p06Zce+21
5OTkcO2111b5/v62S7v33nu56qqrGDVqFAkJCQwePJi1a9cCcPPNN9OpUyc6dOhAnz59GDx4cEDp
7dGjBw8//DAjR47knHPOYdiwYWX+rvT5AduC6v3332fDhg106dKFtm3bcvvtt3P8+HGf+1f1P772
2mucPXuW3r17k5yczNixYz25nKqOde+99/L222+TnJzM5MmTOX78OLfffjvJyclkZmbSpk0bHnjg
gUrPZzCEv2FvcJjqRHqRYNJotTBjxgy+/vprXnvttXAnRXwI1mi1qvQWkVo5fPgwr7zyCq+//nq4
kyIhFu4iqUuBrcDXwIOV7POs6/WNQL86SpeIBODFF18kIyOD0aNHM3To0HAnR0IsnEVSDYD/AiOB
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
">
</img></div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">
<img src="data:image/png;base64,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
hBq8vRgNWYkAAAAASUVORK5CYII=
">
</img></div>
</div>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Baysian-Filtering">Baysian Filtering<a class="anchor-link" href="#Baysian-Filtering">¶</a></h1>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In many applications of HMMs, the observed data arrives sequentially over time leading to
online inference problems such as Bayesian filtering. In this case, we want to estimate the
posterior distribution $p(x_t|y_1,\ldots, y_t)$. This is the distribution over  just the current state
at time $t$ given all measurements up to and including time $t$. Note that we are not asking
here about the full history of the system state, but only the latest state. If the full history
is needed, it might be best to use MCMC methods. In the filtering task, SMC methods can
be applied efficiently because the results of the inference procedure at time $t$ can be re-used
again at time $t + 1$.</p>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Particle-Filters">Particle Filters<a class="anchor-link" href="#Particle-Filters">¶</a></h2>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the SMC approach to filtering, the posterior distribution over the current latent state
is based on an approximation from a finite set of samples. Particle filtering is one form of
SMC. In particle filters, each particle represents a sample or hypothesis about the current
latent state. As the number of particles increases, the approximation improves and starts to
resemble to the exact Bayesian posterior. Although a low number of particles is not desirable
for engineering applications, as it can lead to poor approximations, they can be very useful
to explain suboptimal human performance in a number of sequential tasks. Note that particle filtering does not refer to a particular algorithm that rather a general approach – there are many different methods to implement particle filters.</p>
<p>A particularly attractive feature of particle filters is that no memory of previous states
is needed. All the information needed for the filtering task is contained in a fixed set of
particles leading to a constant memory demand over time. However, when applying particle
filters to high-dimensional problems, a very large number of particles might be needed to
achieve good performance. This can in some cases lead to very slow performance, especially
when overly simplistic particle filters are used.</p>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sample-Importance-Resampling-(SIR)">Sample Importance Resampling (SIR)<a class="anchor-link" href="#Sample-Importance-Resampling-(SIR)">¶</a></h2>
</div>
</div>
</div>
<div class="input">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the most basic particle filters is Sampling Importance Resampling (SIR). It is based
on the idea of importance sampling where a distribution is approximated by a set of samples
weighted by the density of the target function such that the dense regions of the posterior
are more heavily weighted than the tails. In the SIR filter, we always work with a fixed set
of $M$ particles. To introduce notation, let $x^i_t$ represent the hypothesis about the latent state
of the ith particle at time $t$. Across particles, we can approximate the distribution of the
filtered estimate at time $t$ by the set of particles $\{x^i_t\}$. If a point estimate is needed for the latent state, we can take the mode or mean of this distribution. </p>
<p>The SIR particle filter as described below is desirable for its simplicity. It only requires that one can sample from the
state transition distribution $p(x_t|x_{t-1})$ and can evaluate the likelihood 
$p(y_t|x_t)$.</p>
<p>We initialize the particle filter by sampling each particle from the prior distribution
$p(x_0)$. At each iteration, we then evolve the set of particles from the last generation. First,
we sample for each particle from the last generation a candidate hypothesis for the current
latent state. Therefore, each particle leads to a projection of the hidden state to the current
time step. We then calculate the likelihood of the current observation $y_t$ under each particle.
This likelihood serves as the importance weight. We then normalize the importance weights
across particles. In the second step, we evolve the set of particles from the last generation
by sampling, with replacement, from the candidate hypotheses weighted by the importance
weights. Therefore, candidate hypotheses that make the current observations likely lead to
higher importance weights and are more likely to be sampled. This resampling continues
until $M$ new particles are generated.</p>
<p>Note that in the resampling step, the same proposal can be sampled multiple times. Also,
a particular proposal might not be sampled at all. Therefore, each particle can lead to a
varying number of “oﬀspring” depending on the proximity of particle to the region in state
space that best explains the current observation – bad particles die out and are taken over
by particles that do (at least for the current time step) explain the data.
In this particular version of SIR, the proposal distribution equals the state transition
distribution. This version of SIR is also known as the bootstrap or condensation algorithm.
It is important to realize that this choice of proposal distribution can lead to problems with
high-dimensional cases. This is because in the first step of the SIR approach, we sample
proposals from the state transition distribution without taking the current observation into
account. The current observation is taken into account only in the second step, by weighting
each particle by the likelihood. Therefore, we are blindly proposing how the current hidden
state evolves from the last state and then correct only afterwards for any unlikely proposals. 
In some cases, this leads to a situation where none of the candidate proposals come near
the regions in the state space that can adequately explain the current observation. In other
versions of SIR particle filters, more complex proposal distributions are used that do take
the current observation into account (in the proposal generation). Also, some authors have
proposed methods such as unscented Kalman filters to deal with this problem. The number of
particles, $M$ was set to 100. The bottom panel shows the distribution over particles for each
iteration. The middle panel shows the mode of the particles to create a point estimate for
the latent state at each time t. Importantly, remember that in the filtering task, a filtering
estimate at time t implies that all data up to and including time t has been observed.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [43]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="c">#let's do an example with Pavlos smiling. Pavlos can either be happy or sad. Pavlos switches moods about once every ten seconds (typical).</span>
<span class="c">#If Pavlos is happy, there is a .8 chance that he will smile. If he is sad, there is only .2 chance of him smiling.</span>

<span class="c">#probability that Pavlos will switch moods this second</span>
<span class="n">a</span><span class="o">=.</span><span class="mi">1</span>

<span class="c">#probability that Pavlos will smile, given that he's happy (1-b if he's not happy)</span>
<span class="n">b</span><span class="o">=.</span><span class="mi">8</span>

<span class="c">#we can thus generate an set of observations based on this model</span>
<span class="n">Ttotal</span><span class="o">=</span><span class="mi">200</span>

<span class="c">#hidden states</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 
<span class="c">#observed states</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">xs</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xs</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">xs</span><span class="p">[</span><span class="n">t</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ttotal</span><span class="p">)],</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ttotal</span><span class="p">)],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'happy?'</span><span class="p">,</span> <span class="s">'smiling?'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'time'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">
    Out[43]:</div>
<div class="box-flex1 output_subarea output_pyout">
<pre>
&lt;matplotlib.text.Text at 0x1082d62d0&gt;
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">
<img src="data:image/png;base64,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
9es58cQTOeWUU9h111055JBDuPPOOzn77LNZvXo1++23Hz/72c+Sc6xbt47zzjsv8/ymafKHP/wB
gNNOO433vOc9vOIVr2DXXXfliCOOSLYBXH755Rx00EGsWLGC97znPRxzzDHJeZd6uchhCMCVwKaS
fUYp4lgQhCcwt99+O1/4whe49tpr2bp1K5dffnlirvnxj3/MqaeeyqZNmzj00EM57rjjAHjggQf4
u7/7O975zncm54lnEa3Cd77zHdavX8+mTZs48MAD+chHPgLAY489xoknnsg555zDxo0bOeigg7jq
qqt6zrtUy0XuiMngQuBI4EbgfuD9wC07IF1BEJYQ46zhtPvCj9WbbsKyLFqtFjfffDNPetKTePKT
n5xse9GLXpS89E844QR+8IMf8OEPfxjDMDjppJN4xzvewdatW9l1110rp2cYBq997WuTFcDe9KY3
8b73vQ+I/AjPfOYzefWrXw3AGWecwac+9amec7z+9a9nzZo1nHPOObWudVB2hABcB+wLzAMvAy4C
nrYD0hUEYQmp++IeFgceeCDnnnsu69ev5+abb+YlL3kJn/nMZwDYY489kv0mJydZtWpV0hqfnJwE
ooVj6ggAwOrVq1PnnZ2dBaKexZo1a1L76t+XcrnIHSEA25TPlwL/CuwGbNR3XL9+ffJ53bp1rFu3
bjtnTRCEJyInn3wyJ598Mtu2beOd73wnH/rQhzjggAN2eD723ntvfvSjHyXfwzDkvvvuS+1Td7nI
mZkZZmZmhpK/HSEAq4FHiExBzyfyB/S8/CEtAIIgCP1wxx13cN9993HUUUfRbDaZmJjYrrOWFp37
+OOP5/TTT+fiiy/m5S9/OV/60pd46KGHUvvUXS5SbxzrS1vWYRj9jX8HfgMcBPwReCvwzs4fwAlE
Q0RvAM4F3jCENAVBEDJptVqceeaZ7L777uy111489thjnH322UDvnP5l39Xf9eUj87ap21etWsWF
F17IBz/4QVatWsWtt97K4YcfTrPZTPZdyuUiR2l0jqwHIAg7EbIeQH2CIGDfffflW9/6Fsccc0yt
Y2U9AEEQhJ2Myy+/nM2bN9NqtfiHf/gHAI444oglzlWECIAgCMJ25KqrruLAAw9k99135z/+4z+4
6KKLUiagpURMQIIg9IWYgHYsYgISBEEQhoYIgCAIwpgiAiAIgjCm7IhAMEEQnoCsXLmy8mRpwuCs
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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [48]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="c">#number of particles</span>
<span class="n">M</span><span class="o">=</span><span class="mi">100</span>

<span class="n">xp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">M</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">))</span>
<span class="n">x</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">))</span>

<span class="c">#contains weights for each particle at each time step</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">M</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">))</span>

<span class="c">#normalize weights</span>
<span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="n">M</span>

<span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Ttotal</span><span class="p">):</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="c"># a 1 x M random prob matrix</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">r1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c"># change the predicted output</span>
            <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c"># don't change the predicted output</span>
        <span class="c"># generate weight based on observation likelihood</span>
        <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]:</span>
            <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">b</span>
    <span class="c">#normalize</span>
    <span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span>
    
    <span class="c">#generate M new particles</span>
    <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]:</span>
            <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>

<span class="c"># calculte the averaged predicted hidden state</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Ttotal</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ttotal</span><span class="p">):</span>
    <span class="n">pred</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">xp</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span><span class="o">/</span><span class="n">M</span><span class="p">)</span>

<span class="c">#plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ttotal</span><span class="p">)],</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ttotal</span><span class="p">)],</span> <span class="n">pred</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'actual hidden state'</span><span class="p">,</span> <span class="s">'predicted hidden state'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'mood'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">
    Out[48]:</div>
<div class="box-flex1 output_subarea output_pyout">
<pre>
&lt;matplotlib.text.Text at 0x10962f690&gt;
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">
<img src="data:image/png;base64,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
P+yh9eor9eJKAAAAAElFTkSuQmCC
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [1]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [1]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In [1]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell">
<div class="input">
<div class="prompt input_prompt">
In []:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>
</div>
</div>
</div></p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">
<aside>
    <section>
        <ul class="list-group list-group-flush">


                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Class Material</h4></li>
                    <li class="list-group-item">
                       <a href="http://iacs-courses.seas.harvard.edu/courses/am207/tag/homeworks.html">
                           <i class="icon-folder-open icon-large"></i>homeworks
                       </a>
                   </li>
                    <li class="list-group-item">
                       <a href="http://iacs-courses.seas.harvard.edu/courses/am207/tag/labs.html">
                           <i class="icon-folder-open icon-large"></i>labs
                       </a>
                   </li>
                    <li class="list-group-item">
                       <a href="http://iacs-courses.seas.harvard.edu/courses/am207/tag/projects.html">
                           <i class="icon-folder-open icon-large"></i>projects
                       </a>
                   </li>
                    <li class="list-group-item">
                       <a href="http://iacs-courses.seas.harvard.edu/courses/am207/tag/lectures.html">
                           <i class="icon-folder-open icon-large"></i>lectures
                       </a>
                   </li>

            <!--li class="list-group-item"><a href="http://iacs-courses.seas.harvard.edu/courses/am207/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li-->
                <li class="list-group-item"><h4><i class="icon-external-link icon-large"></i>Class Links</h4></li>
                    <li class="list-group-item"><a href="https://piazza.com/harvard/spring2014/am207/home"><i class="icon-external-link"></i>Piazza</a></li>
                    <li class="list-group-item"><a href="http://cm.dce.harvard.edu/2014/02/24104/publicationListing.shtml"><i class="icon-external-link"></i>Videos</a></li>
                    <li class="list-group-item"><a href="http://isites.harvard.edu/icb/icb.do?keyword=k102129&login=yes"><i class="icon-external-link"></i>ISite</a></li>
                <li class="list-group-item"><h4><i class="icon-external-link icon-large"></i>Other Links</h4></li>
                    <li class="list-group-item"><a href="http://docs.scipy.org/doc/numpy/reference/"><i class="icon-external-link"></i>Numpy</a></li>
                    <li class="list-group-item"><a href="http://docs.scipy.org/doc/scipy/reference/"><i class="icon-external-link"></i>Scipy</a></li>
                    <li class="list-group-item"><a href="http://pandas.pydata.org/pandas-docs/dev/"><i class="icon-external-link"></i>Pandas</a></li>
                    <li class="list-group-item"><a href="http://matplotlib.org/api/index.html"><i class="icon-external-link"></i>Matplotlib</a></li>
                    <li class="list-group-item"><a href="https://github.com/pymc-devs/pymc"><i class="icon-external-link"></i>PyMC3</a></li>
                    <li class="list-group-item"><a href="http://iacs.seas.harvard.edu"><i class="icon-external-link"></i>IACS</a></li>
        </ul>
    </section>
</aside>        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://iacs-courses.seas.harvard.edu/courses/am207/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://iacs-courses.seas.harvard.edu/courses/am207/theme/js/respond.min.js"></script>
</body>
</html>